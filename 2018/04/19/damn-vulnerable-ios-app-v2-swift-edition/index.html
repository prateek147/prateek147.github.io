
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Releasing Damn Vulnerable iOS App v2.0 - written in Swift - Prateek Gianchandani</title>
  <meta name="author" content="Prateek Gianchandani">

  
  <meta name="description" content="Releasing Damn Vulnerable iOS App v2.0 - Written in Swift Apr 19th, 2018 Posted by Prateek Gianchandani I am glad to release a completely new &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://prateek147.github.io/2018/04/19/damn-vulnerable-ios-app-v2-swift-edition">
  <link href="/favicon.png" rel="icon">
  <link href='http://fonts.googleapis.com/css?family=Quicksand:300,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,300' rel='stylesheet' type='text/css'>
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Prateek Gianchandani" type="application/atom+xml">
  <script src="/js/jquery.js"></script>
  <script src="/js/bootstrap-collapse.js"></script>
  <script src="/js/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/js/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-41877509-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <div class="navbar navbar-inverse navbar-static-top">
  	<div class="navbar-inner">
  	  <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
          <span class="fui-menu-24"></span>
        </a>
  	  	<div class="nav-collapse collapse navbar-responsive-collapse" style="height:0;">
  	      <ul class="nav">
    
        <li ><a href="/index.html">Home</a></li>
    
        <li ><a href="/security/">Security</a></li>
    
        <li ><a href="/everest/">Everest</a></li>
    
        <li ><a href="/archives/index.html">Archives</a></li>
    
        <li ><a href="http://damnvulnerableiosapp.com">DVIA</a></li>
    
        <li ><a href="/about/">About Me</a></li>
    
</ul>

<ul class="nav pull-right">
    
    <li><a href="http://github.com/prateek147" title="Github Profile"><i class="icon-github-sign social-navbar"></i></a></li>
    
    
    <li><a href="http://linkedin.com/in/prateekgianchandani" title="Linkedin Profile"><i class="icon-linkedin-sign social-navbar"></i></a></li>
    
    
    <li><a href="http://twitter.com/prateekg147" title="Twitter Profile"><i class="icon-twitter-sign social-navbar"></i></a></li>
    
    
    
</ul>

  	    </div>
  	  </div>
  	</div>
  </div>
  <div class="container" id="main">
    <div class="span12">
      <div class="row-fluid">
        <div id="content">
          <div>
<article class="hentry" role="article">
  

  <header>
  <div class="jumbotron">
    Releasing Damn Vulnerable iOS App v2.0 - Written in Swift
	<h5>








  


<i class="icon-calendar-empty"></i> <time datetime="2018-04-19T01:03:00+04:00" pubdate data-updated="true">Apr 19<span>th</span>, 2018</time></h5>
  <h4>
  

<p>Posted by <a href="http://highaltitudehacks.com/about/">Prateek Gianchandani</a></p>
<h4>
  </div>
</header>
  <div class="row-fluid">
    <div class="span12">
      <p>I am glad to release a completely new version of <a href="http://damnvulnerableiosapp.com">Damn Vulnerable iOS App</a> written in Swift 4. With developers now migrating to Swift for developing apps, it is important to have a testbed app for iOS in Swift. Though I have added some sections in Objective-C too which the users can use to test Objective-C related vulns.</p>

<p><img src="/images/posts/dvia2/1.png" width="310" height="552" alt="1"></p>

<p>The following vulnerabilities are covered in this version.</p>

<ol>
<li><b>Local Data Storage</b> - Data Storage in Plist, UserDefaults, Keychain, CoreData, Webkit Cache, Realm, Couchbase and YapDatabase.</li>
<li><b>Jailbreak Detection</b> - 5 challenges in this section. Apart from the usual checks where you can use runtime manipulation and attach debuggers to bypass Jailbreak detection, users will have to mitigate scenarios where there is added runtime protection, use of inline functions, string obfuscation, and certain edge cases, for e.g the exiting when a jailbroken device is detected.</li>
<li><b>Excessive Permissions</b> - A demo on how app permissions can be misused, as demonstrated by Krause originally.</li>
<li><b>Runtime Manipulation</b> - Use runtime manipulation to modify instance variables, bypass local login checks, and brute force pin codes. In some cases, you might have to attach a debugger.</li>
<li><b>Anti Anti Hooking/Debugging</b> - Enabling these will detect when a debugger or a runtime analysis tool such as Cycript. There is also detection for MobileSubstrate, SSLKillSwitch2 etc. Try and work your way around it and see if you can still solve other challenges with these limitations. Reverse & Patch, Patch, Patch ! </li>
<li><b>Binary Protection</b> - Do some binary analysis to see whether ARC, PIE, Stack smashing is enabled. Find the signature used to sign the binary and the entitlements it has. Also check if the app is stripped of its symbols or not.</li>
<li><b>Touch/Face ID Bypass</b> - Bypass Touch ID authentication when insecure APIs (LAContext) are being used.</li>
<li><b>Phishing</b> - Demonstration of alerts generated by app that look like the ones generated from App Store, which can potentially be used for conducting phishing attacks. Original idea by Krause.</li>
<li><b>Side Channel Data Leakage</b> - Understand the different kinds of Side Channel Data leakage such as Device Logs, Pasteboard, App Screenshot, Keystroke Logging, Insecure APIs used for HTTP Cookies etc.</li>
<li><b>IPC Issues</b> - Solve this challenge to understand what can happen when an app is receiving requests via URL schemes from untrusted sources and doesn&#8217;t validate it properly.</li>
<li><b>Broken Cryptography</b> - Bypass 2 encryption and hashing implementations, one with AES encryption and the other one with PBKDF2 with less rounds of hashing.</li>
<li><b>Webview Issues</b> - Understand injections in Webviews.</li>
<li><b>Network Layer Security</b> - Capture traffic over HTTP and HTTPs. Bypass Certificate and Public Key Pinning. Also understand what is ATS (App Transport Security) and check whether it is implemented or not.</li>
<li><b>Application Patching</b> - Patch login checks, jailbreak detection methods, and in specific certain specific instructions used in the app.</li>
<li><b>Sensitive Information in Memory</b> - Dump the information from the memory to look at the sensitive data.</li>
</ol>




<!-- more -->




<h2>Installing DVIA on any iOS device </h2>


<p>The best way to install DVIA on any device (jailbroken or not) is using <a href="http://www.cydiaimpactor.com/
">Cydia Impactor</a>. However, it would be ideal to have a jailbroken device for testing as most of the vulnerabilities can be exploited only with the use of a JB device.</p>

<h3>Steps</h3>




<ol>
<li>Create an Apple ID https://appleid.apple.com/account.</li>
<li>Download <em>Impactor</em>, make sure the device you want to install the app on is connected to your computer. Now drag and drop the <em>IPA</em> file to <em>Impactor</em>.</li>
<li>Enter your Apple ID credentials. App will install on the device.</li>
<li>Go to your device, <em>Settings -> General -> Device Management</em>. Select the Apple ID you used to install the app. Click on <em>Verify App</em> under DVIAv2.</li>
</ol>




<p><h2>Compiling DVIA using Xcode </h3></p>

<p><h3>Steps</h3></p>

<p><ol>
<li>Clone the DVIA repo , git clone <a href="https://github.com/prateek147/DVIA-v2">https://github.com/prateek147/DVIA-v2</a></li>
<li>cd to the project root directory where the <em>Podfile</em> is present (/DVIA-v2/DVIA-v2). Then run <em>pod install</em></li>
<li>Open the <em>DVIA-v2.xcworkspace</em> file with Xcode. You can now directly run the app on a simulator.</li>
<li>For running on the device, go under Project settings in Xcode on the top left, head over to the <em>General</em> tab and under <em>Signing</em>, enter credentials for your Apple ID.</li>
<li>Now you can build and run the project on the device. You will have to trust the app again by going under Settings &ndash;> General &ndash;> Device Management. </li>
</ol></p>

<p><h3>Some Important Links</h3></p>

<p><ol>
<li>Application Website &ndash; <a href="http://damnvulnerableiosapp.com">Here</a></li>
<li>Github Page &ndash; <a href="https://github.com/prateek147/DVIA-v2"><a href="https://github.com/prateek147/DVIA-v2">https://github.com/prateek147/DVIA-v2</a></a></li>
<li>Download Page &ndash; <a href="http://damnvulnerableiosapp.com#downloads">Here</a></li>
</ol></p>

<p><h2>Donate</h2></p>

<p><p>if you benefit from this project and want to make a contribution, please consider making a donation to The Juniper Fund (www.thejuniperfund.org/)</p></p>

<p><p>The Juniper fund is focusing on high altitude workers involved with climbing and expedition support in the high mountains of Nepal. When a high altitude worker has an accident (death or debilitating injury), the impact to the family is devastating. The juniper fund provides funds to the affected families with a 3-Tier model &ndash; Cost of Living grant, vocational training and small business grant. For more information,  visit <a href="http://www.thejuniperfund.org">www.thejuniperfund.org</a>.</p></p>

<p><p>Or watch the videos below.</p></p>

<p><iframe width="560" height="314" src="https://www.youtube.com/embed/HsV6jaA5J2I" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></p>

<p><iframe width="560" height="315" src="https://www.youtube.com/embed/6dHXcoF590E" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></p>

<p><strong>Solutions</strong>
<p>I am still working on the solutions and would post them in form of blog posts starting soon.</p>
<p>For any questions, shoot me an email at Prateek at damnvulnerableiosapp.com or DM me on <a href="https://twitter.com/prateekg147">Twitter</a>. For any bugs/functionalities, please raise them via the <a href="https://github.com/prateek147/DVIA-v2">Github</a> page.</p></p>

<p><p>Happy Hacking !</p></p>

    </div>
  </div>



  <footer>
    <hr>
    
    <div class="row-fluid">
      
      <div class="span6">
        <p class="meta">
        
        



  <a href="//categories/security/"><span class="badge">security</span></a>




        </p>
      </div>
      
      <div class="span6 social-sharing">
        <div class="sharing">
  <div class="addthis_toolbox addthis_default_style ">
  
  <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
  
  
  <a class="addthis_button_tweet"></a>
  
  
  <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>

      </div>
      
      
    </div>
    
    <div class="row-fluid">
      <div class="span12">
        <p class="meta">
          
            <a class="basic-alignment left" href="/2016/06/23/ios-application-security-part-46-app-transport-security" title="Previous Post: iOS Application Security Part 46 - App Transport Security">&laquo; iOS Application Security Part 46 - App Transport Security</a>
          
          
        </p>
      </div>
    </div>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>



        </div>
      </div>
      <div class="row-fluid">
        <footer class="footer-page" role="contentinfo">
          <p>
  Copyright &copy; 2018 - Prateek Gianchandani -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span> - Theme by <a href="http://alexgaribay.com">Alex Garibay</a>
</p>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-41877509-1', 'highaltitudehacks.com');
  ga('send', 'pageview');

</script>

<!-- Start of StatCounter Code for Default Guide -->
<script type="text/javascript">
var sc_project=9078428; 
var sc_invisible=1; 
var sc_security="a08bf0bd"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="web analytics"
href="http://statcounter.com/" target="_blank"><img
class="statcounter"
src="http://c.statcounter.com/9078428/0/a08bf0bd/1/"
alt="web analytics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->
        </footer>
      </div>
    </div>
  </div>
  

<script type="text/javascript">
      var disqus_shortname = 'highaltitudehacks';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://prateek147.github.io/2018/04/19/damn-vulnerable-ios-app-v2-swift-edition';
        var disqus_url = 'http://prateek147.github.io/2018/04/19/damn-vulnerable-ios-app-v2-swift-edition';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
