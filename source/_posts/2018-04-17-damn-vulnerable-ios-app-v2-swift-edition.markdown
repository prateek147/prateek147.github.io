---
layout: post
title: "Releasing Damn Vulnerable iOS App v2.0 - written in Swift"
date: 2018-04-19 01:03
comments: true
categories: [security]
---

I am glad to release a completely new version of <a href="http://damnvulnerableiosapp.com">Damn Vulnerable iOS App</a> written in Swift 4. With developers now migrating to Swift for developing apps, it is important to have a testbed app for iOS in Swift. Though I have added some sections in Objective-C too which the users can test to learn Objective-C related vulns.

<img src="/images/posts/dvia2/dvia.png" width="310" height="552" alt="1">

The following vulnerabilities are covered in this version. 

<ol>
<li><b>Local Data Storage</b> - Data Storage in Plist, UserDefaults, Keychain, CoreData, Webkit Cache, Realm, Couchbase and YapDatabase.</li>
<li><b>Jailbreak Detection</b> - 5 challenges in this section. Apart from the usual checks where you can use runtime manipulation and attach debuggers to bypass Jailbreak detection, users will have to mitigate scenarios where there is added runtime protection, use of inline functions, string obfuscation, and certain edge cases, for e.g the exiting of an app when a jailbroken device is detected.</li>
<li><b>Excessive Permissions</b> - A demo on how app permissions can be misused, as demonstrated by Krause originally.</li>
<li><b>Runtime Manipulation</b> - Use runtime manipulation to modify instance variables, bypass local login checks, and brute force pin codes. In some cases, you might have to attach a debugger.</li>
<li><b>Anti Anti Hooking/Debugging</b> - Enabling these will detect when a debugger or a runtime analysis tool such as Cycript is attached to the app. There is also detection for MobileSubstrate, SSLKillSwitch2 etc. Try and work your way around it and see if you can still solve other challenges with these limitations. Reverse & Patch, Patch, Patch ! </li>
<li><b>Binary Protection</b> - Do some binary analysis to identify whether ARC, PIE, Stack smashing is enabled. Find the signature used to sign the binary and the entitlements it has. Also check if the app is stripped of its symbols or not.</li>
<li><b>Touch/Face ID Bypass</b> - Bypass Touch ID authentication when insecure APIs (LAContext) are being used.</li>
<li><b>Phishing</b> - Demonstration of alerts generated by app that look like the ones generated from App Store, which can potentially be used for conducting phishing attacks. Original idea by Krause.</li>
<li><b>Side Channel Data Leakage</b> - Understand the different kinds of Side Channel Data leakage such as Device Logs, Pasteboard, App Screenshot, Keystroke Logging, Insecure APIs used for HTTP Cookies etc.</li>
<li><b>IPC Issues</b> - Solve this challenge to understand what can happen when an app is receiving requests via URL schemes from untrusted sources and doesn't validate it properly.</li>
<li><b>Broken Cryptography</b> - Bypass 2 encryption and hashing implementations, one with AES  and the other one with PBKDF2 with only few rounds of hashing.</li>
<li><b>Webview Issues</b> - Understand injections in Webviews.</li>
<li><b>Network Layer Security</b> - Capture traffic over HTTP and HTTPs. Bypass Certificate and Public Key Pinning. Also understand what is ATS (App Transport Security) and check whether it is implemented or not.</li>
<li><b>Application Patching</b> - Patch login checks, jailbreak detection methods, and in specific certain specific instructions used in the app.</li>
<li><b>Sensitive Information in Memory</b> - Dump the information from the memory to look at the sensitive data.</li>
</ol>

<!-- more -->

<h2>Installing DVIA on any iOS device </h2>

The best way to install DVIA on any device (jailbroken or not) is using <a href="http://www.cydiaimpactor.com/
">Cydia Impactor</a>. However, it would be ideal to have a jailbroken device for testing as most of the vulnerabilities can be exploited only with the use of a JB device.

<h3>Steps</h3>

<ol>
<li>Create an Apple ID https://appleid.apple.com/account.</li>
<li>Download <em>Impactor</em>, make sure the device you want to install the app on is connected to your computer. Now drag and drop the <em>IPA</em> file to <em>Impactor</em>.</li>
<li>Enter your Apple ID credentials. App will install on the device.</li>
<li>Go to your device, <em>Settings -> General -> Device Management</em>. Select the Apple ID you used to install the app. Click on <em>Verify App</em> under DVIAv2.</li>
</ol>

<h2>Compiling DVIA using Xcode </h2>

<h3>Steps</h3>

<ol>
<li>Clone the DVIA repo , git clone https://github.com/prateek147/DVIA-v2</li>
<li>cd to the project root directory where the <em>Podfile</em> is present (/DVIA-v2/DVIA-v2). Then run <em>pod install</em></li>
<li>Open the <em>DVIA-v2.xcworkspace</em> file with Xcode. You can now directly run the app on a simulator.</li>
<li>For running on the device, go under Project settings in Xcode on the top left, head over to the <em>General</em> tab and under <em>Signing</em>, enter credentials for your Apple ID.</li>
<li>Now you can build and run the project on the device. You will have to trust the app again by going under Settings -> General -> Device Management. </li>
</ol>


<h2>Some Important Links</h2>

<ol>
<li>Application Website - <a href="http://damnvulnerableiosapp.com">Here</a></li>
<li>Github Page - <a href="https://github.com/prateek147/DVIA-v2">https://github.com/prateek147/DVIA-v2</a></li>
<li>Download Page - <a href="http://damnvulnerableiosapp.com#downloads">Here</a></li>
</ol>


<h2>Donate</h2>

<p>if you benefit from this project and want to make a contribution, please consider making a donation to The Juniper Fund (www.thejuniperfund.org/)</p>

<p>The Juniper fund is focusing on high altitude workers involved with climbing and expedition support in the high mountains of Nepal. When a high altitude worker has an accident (death or debilitating injury), the impact to the family is devastating. The juniper fund provides funds to the affected families with a 3-Tier model - Cost of Living grant, vocational training and small business grant. For more information,  visit <a href="http://www.thejuniperfund.org">www.thejuniperfund.org</a>.</p>

<p>Or watch the videos below.</p>

<iframe width="560" height="314" src="https://www.youtube.com/embed/HsV6jaA5J2I" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

<iframe width="560" height="315" src="https://www.youtube.com/embed/6dHXcoF590E" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

<strong>Solutions</strong>
<p>I am still working on the solutions and would post them in form of blog posts starting soon.</p>
<p>For any questions, shoot me an email at Prateek at damnvulnerableiosapp.com or DM me on <a href="https://twitter.com/prateekg147">Twitter</a>. For any bugs/functionalities, please raise them via the <a href="https://github.com/prateek147/DVIA-v2">Github</a> page.</p>

<p>Happy Hacking !</p>